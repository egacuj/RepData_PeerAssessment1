sub1 <- subset(ssd, subject == 1)
dim(sub(1)
)
dim(sub1)
names(sub1[1:12])
myedit("showXY.R")
showMe(1:6)
mdist <- dist(sub1[,1:3])
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
hclustering
mdist <- dist(sub1[,10:12])
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
str(sub1)
names(sub1[, 10:12])
-c(562,563)
sub1[,-c(562,563)]
a <- sub1[,-c(562,563)]
View(a)
svd1 <- svd(scale(sub1[,-c(562,563)]))
dim(svd1$u)
maxCon <- which.max(svd1$v)
maxCon <- which.max(svd1$v[,2])
maxCon
mdist <- dist(sub1[,c(10:12,maxCon)])
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
names(sub1[maxCon])
kClust <- kmeans(sub1$[, length(sub1[1,])-1:length(sub1[1,])], centers = 6)
kClust <- kmeans(sub1[, 1:length(sub1[1,])-2)], centers = 6)
kClust <- kmeans(sub1[, 1:length(sub1[1,])-2], centers = 6)
kClust <- kmeans(sub1[, length(sub1[1,])-2], centers = 6)
kClust <- kmeans(sub1[, -c(562, 563)]
, centers = 6)
table(kCluast$cluster, sub1$activity)
table(kClust$cluster, sub1$activity)
kClust <- kmeans(sub1[, -c(562, 563)], center = 100)
kClust <- kmeans(sub1[, -c(562, 563)], center = 6, nstart = 100)
table(kClust$cluster, sub1$activity)
dim(kClust$centers)
laying <- which(kClust$size == 29)
plot(kClust$centers[laying, 1:12], pch = 19, ylab = "Laying Cluster")
names(sub1[1:3])
names(sub1[1:3])
walkdown <- which(kClust$size==49)
walkdown <- which(kClust$size==49)
plot(kClust$centers[walkdown, 1:12],pch=19,ylab="Walkdown Cluster")
plot(kClust$centers[walkdown, 1:12],pch=19,ylab="Walkdown Cluster")
dim(ssd)
dim(ssd)
names(ssd[562:563])
table(ssd$subject)
sum(table(ssd$subject)))
sum(table(ssd$subject))
table(ssd$activity)
sub1 <- subset(ssd, subject == 1)
dim(sub1)
names(sub1[1:12])
myedit("showXY.R")
showMe(1:6)
mdist <- dist(sub1[,1:3])
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
hclustering
mdist <- dist(sub1[,10:12])
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
str(sub1)
myplclust(hclustering, lab.col = unclass(sub1$activity))
svd1 <- svd(scale(sub1[,-c(562,563)]))
dim(svd1$u)
maxCon <- which.max(svd1$v)
maxCon <- which.max(svd1$v[,2])
maxCon
mdist <- dist(sub1[,c(10:12,maxCon)])
hclustering <- hclust(mdist)
hclustering <- hclust(mdist)
myplclust(hclustering, lab.col = unclass(sub1$activity))
names(sub1[maxCon])
kClust <- kmeans(sub1$[, length(sub1[1,])-1:length(sub1[1,])], centers = 6)
kClust <- kmeans(sub1[, -c(562, 563)]
, centers = 6)
table(kCluast$cluster, sub1$activity)
table(kClust$cluster, sub1$activity)
kClust <- kmeans(sub1[, -c(562, 563)], center = 100)
kClust <- kmeans(sub1[, -c(562, 563)], center = 6, nstart = 100)
table(kClust$cluster, sub1$activity)
laying <- which(kClust$size == 29)
plot(kClust$centers[laying, 1:12], pch = 19, ylab = "Laying Cluster")
names(sub1[1:3])
names(sub1[1:3])
walkdown <- which(kClust$size==49)
walkdown <- which(kClust$size==49)
plot(kClust$centers[walkdown, 1:12],pch=19,ylab="Walkdown Cluster")
plot(kClust$centers[walkdown, 1:12],pch=19,ylab="Walkdown Cluster")
dim(ssd)
dim(ssd)
names(ssd[562:563])
dim(kClust$centers)
laying <- which(kClust$size == 29)
plot(kClust$centers[laying, 1:12], pch = 19, ylab = "Laying Cluster")
names(sub1[1:3])
names(sub1[1:3])
walkdown <- which(kClust$size==49)
walkdown <- which(kClust$size==49)
plot(kClust$centers[walkdown, 1:12],pch=19,ylab="Walkdown Cluster")
rbinom(1, size = 1, prob = 0.5)
rbinom(10, size = 1, prob = 0.5)
rbinom(10, size = 10, prob = 0.5)
getwd()
setwd("D:/R-3.5.0/WorkDirectory/coursera/Reproducible_Research/Proj1/RepData_PeerAssessment1/")
dataSet <- read.csv("activity.zip")
dataSet <- read.csv("activity.zip")
if(!file.exists("activity.csv")){
unzip(zipfile = "activity.zip")
}
dataSet <- read.csv("activity.csv")
View(dataSet)
class(dataSet$date)
?as.Date
as.Date(dataSet$date, "%Y-%m-%d")
dataSet$date <- as.Date(dataSet$date, "%Y-%m-%d")
class(dataSet$date)
noStepDay <- tapply(dataSet$steps, dataSet$date, sum)
noStepDay
hist(noStepDay)
hist(noStepDay, 10)
levels(dataSet$date)
levels(as.factor(dataSet$date))
hist(noStepDay, 20)
hist(noStepDay, 200)
hist(noStepDay, 10)
hist(noStepDay, 15)
hist(noStepDay, 15, col = "red")
hist(noStepDay, 15, col = "grey")
noStepDayMean <- mean(noStepDay)
noStepDayMean
noStepDayMean <- mean(noStepDay, na.rm = T)
noStepDayMean
summary(noStepDay)
noStepItv <- tapply(dataSet$steps, dataSet$interval, mean)
noStepItv
noStepItv <- tapply(dataSet$steps, dataSet$interval, mean, na.rm = T)
noStepItv
plot(dataSet$interval, noStepItv, type = "l")
dataSet$interval
plot(unique(dataSet$interval), noStepItv, type = "l")
?ggplot
??ggplot
library(ggplot2)
?ggplot
g <- ggplot(noStepItv, aes(unique(dataSet$interval), noStepItv)
geom_line() + geom_point()+ggtitle("Question 3: Emissions in Baltimore against Type")
g <- ggplot(noStepItv, aes(unique(dataSet$interval), noStepItv)
g + geom_line() + geom_point()+ggtitle("Question 3: Emissions in Baltimore against Type")
g <- ggplot(noStepItv, aes(unique(dataSet$interval), )
g + geom_line() + geom_point()+ggtitle("Question 3: Emissions in Baltimore against Type")
g <- ggplot(noStepItv, aes(unique(dataSet$interval), noStepItv) )
g + geom_line() + geom_point()+ggtitle("Question 3: Emissions in Baltimore against Type")
g <- ggplot(noStepItv, aes(unique(dataSet$interval), noStepItv) )
noStepItv
class(noStepItv)
g <- ggplot(noStepItv, aes( noStepItv) )
?group_by
library(dplyr)
?group_by
noStepDay <- group_by(dataSet, dataSet$date)
noStepDay
noStepDay <- dataSet %>% summarise(mean = mean(steps, na.rm = T))
noStepDay
noStepDay <- dataSet %>% summarise()
noStepDay <- dataSet %>% group_by(date) %>% summarize(mean = mean(steps, na.rm = T))
noStepDay
noStepDay <- dataSet %>% group_by(date)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarize
noStepDay
?summarise
noStepDay <- dataSet %>% group_by(date) %>% summarise
noStepDay
noStepDay <- dataSet %>% group_by(date)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise(steps)
noStepDay <- dataSet %>% group_by(date) %>% summarise
noStepDay
?summarise
noStepDay <- dataSet %>% group_by(date) %>% summarise(mean = mean(steps, na.rm = T))
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise_all(funs(mean), na.rm = TRUE)
noStepDay
noStepDay <- dataSet %>% group_by(date)
noStepDay
as.factor(noStepDay$steps)
sum(is.na(noStepDay$steps))
sum(is.nan(noStepDay$steps))
?summarise_
?summarise
noStepDay
mean(noStepDay$steps,na.rm = T)
noStepDay <- dataSet %>% group_by(date) %>% summarise(funs(mean), na.rm = TRUE)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise(mean(steps), na.rm = TRUE)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay
noStepDay <- dataSet %>% group_by(!is.na(steps),date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay
noStepDay <- dataSet %>% group_by([!is.na(steps),],date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay <-  group_by(dataSet[!is.na(steps),],date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay <-  group_by(dataSet[!is.na(dataSet$steps),],dataSet$date) %>% summarise(mean(steps, na.rm = TRUE))
group_by(dataSet[!is.na(dataSet$steps),],dataSet$date)
dataSet[!is.na(dataSet$steps),]
noStepDay <-  group_by(dataSet[!is.na(dataSet$steps),],date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay <-  group_by(dataSet[!is.na(dataSet$steps),],date) %>% summarise(mean(steps, na.rm = TRUE))
noStepDay
noStepDay <- tapply(dataSet$steps, dataSet$date, sum)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise(sum = sum(steps, na.rm = TRUE))
noStepDay
noStepDay <- tapply(dataSet$steps, dataSet$date, sum)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise_all(funs(sum, mean, median), na.rm = TRUE)
noStepDay
noStepDay <- dataSet %>% group_by(date) %>% summarise(sum = sum(steps, na.rm = TRUE))
noStepDay
summary(noStepDay)
hist(noStepDay, 15, col = "grey")
hist(noStepDay$sum, 15, col = "grey")
noStepDay <- dataSet %>% group_by(date) %>% summarise(sum = sum(steps))
summary(noStepDay)
hist(noStepDay$sum, 15, col = "grey")
noStepItv<- dataSet %>% group_by(interval)
noStepItv
noStepItv<- dataSet %>% group_by(interval)%>% summarise(mean = mean(steps))
noStepItv
noStepItv<- dataSet[!is.nan(dataSet$steps),] %>% group_by(interval)%>% summarise(mean = mean(steps))
noStepItv
noStepItv<- dataSet[!is.nan(dataSet$steps),]
noStepItv
noStepItv<- dataSet[!is.na(dataSet$steps),] %>% group_by(interval)%>% summarise(mean = mean(steps))
noStepItv
g <- ggplot(noStepItv, aes(interval, mean) )
g + geom_line() + geom_point()+ggtitle("Question 3: Emissions in Baltimore against Type")
with(noStepItv, plot(interval, mean, type = "l")
with(noStepItv, plot(interval, mean, type = "l"))
with(noStepItv, plot(interval, mean, type = "l"))
with(noStepItv, plot(interval, mean, type = "l"), pch = 20)
with(noStepItv, plot(interval, mean, type = "l", pch = 20) )
with(noStepItv, plot(interval, mean, type = "l", pch = 22) )
noStepItv<- dataSet[!is.na(dataSet$steps),] %>% group_by(interval)%>% summarise(meansteps = mean(steps))
with(noStepItv, plot(interval, mean, type = "l") )
noStepItv<- dataSet[!is.na(dataSet$steps),] %>% group_by(interval)%>% summarise(meansteps = mean(steps))
with(noStepItv, plot(interval, meansteps, type = "l") )
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
which.max(noStepItv$meansteps)
?which.max
noStepItv[which.max(noStepItv$meansteps),)
noStepItv[which.max(noStepItv$meansteps),]
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
noStepItv[which.max(noStepItv$meansteps),"meansteps"]
noStepItv[which.max(noStepItv$meansteps),]
point(noStepItv[which.max(noStepItv$meansteps),])
?plot
points(noStepItv[which.max(noStepItv$meansteps),])
points(noStepItv[which.max(noStepItv$meansteps),], col = "red")
?text
text(noStepItv[which.max(noStepItv$meansteps),], labels = "Max Point")
text(noStepItv[which.max(noStepItv$meansteps),], labels = c("Max at interval ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text(noStepItv[which.max(noStepItv$meansteps),], labels = c("Max at interval ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = c("Max at interval ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = c("Max at interval ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])
text(noStepItv[which.max(noStepItv$meansteps),], labels = ["Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])])
text(noStepItv[which.max(noStepItv$meansteps),], labels = c("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
)
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
)
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
point(noStepItv[which.max(noStepItv$meansteps),])
point(noStepItv[which.max(noStepItv$meansteps),])
points(noStepItv[which.max(noStepItv$meansteps),])
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
text(noStepItv[which.max(noStepItv$meansteps)+3,], labels = paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"])))
noStepItv[which.max(noStepItv$meansteps),]
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text(noStepItv[which.max(noStepItv$meansteps),], labels = text1)
?strwrap
strwrap(text1)
strwrap(text1, width = 10)
strwrap(text1, width = 20)
strwrap(text1, width = 15)
text2 <- paste0("mean = ", as.character(noStepItv[which.max(noStepItv$meansteps),"mean"]))
text2 <- paste0("mean = ", as.character(noStepItv[which.max(noStepItv$meansteps),"meansteps"]))
text2
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = "\n"))
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
points(noStepItv[which.max(noStepItv$meansteps),], col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(noStepItv[which.max(noStepItv$meansteps),"meansteps"]))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = "\n"))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = \n))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = "\n"))
paste(text1, text2, collapse = "\n")
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = "\n"))
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
points(noStepItv[which.max(noStepItv$meansteps),], col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(text1, text2, collapse = "\n"))
paste(text1, text2, collapse = "\n")
title(paste(text1, text2, collapse = "\n"))
cat(paste(text1, text2, collapse = "\n"))
cat(paste(text1, text2, collapse = "\n"))
cat(paste(text1, text2, collapse = "\\n"))
cat(paste(text1, text2, collapse = "n"))
cat(paste(text1, text2, collapse = "      "))
cat(paste(text1, text2, collapse = "haha"))
?paste
paste0(1:12, c("st", "nd", "rd", rep("th", 9))
)
paste0(1,2)
paste0("1","2")
paste0("1","2", collapse = "\n")
cat(paste0("1","2", collapse = "\n"))
cat(paste0(1:2, collapse = "\n"))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(c(text1, text2), collapse = "\n"))
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
points(noStepItv[which.max(noStepItv$meansteps),], col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(c(text1, text2), collapse = "\n"))
?text
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
points(noStepItv[which.max(noStepItv$meansteps),], col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text(noStepItv[which.max(noStepItv$meansteps),], labels = paste(c(text1, text2), collapse = "\n"), pos = 4)
?legend
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean Steps of 5-min Interval") )
points(noStepItv[which.max(noStepItv$meansteps),], pch = 20, col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text = paste(text1, text2, sep = " ")
legend("topright", pch = 20, legend = text)
legend("topright", pch = 20, legend = text, col = "red")
hist(noStepDay$sum, 15, col = "grey")
hist(noStepDay$sum, 15, col = "grey", main = "Histogram of total number of steps taken per day")
hist(noStepDay$sum, 15, col = "grey", main = "Histogram of total number of steps taken per day", xlab = "Total number of steps taken per day")
noStepItv<- dataSet[!is.na(dataSet$steps),] %>% group_by(interval)%>% summarise(meansteps = mean(steps))
with(noStepItv, plot(interval, meansteps, type = "l", main = "Mean steps of 5-min interval") )
points(noStepItv[which.max(noStepItv$meansteps),], pch = 20, col = "red")
text1 <- paste0("Max at interval = ", as.character(noStepItv[which.max(noStepItv$meansteps),"interval"]))
text2 <- paste0("mean = ", as.character(round(noStepItv[which.max(noStepItv$meansteps),"meansteps"])))
text = paste(text1, text2, sep = " ")
legend("topright", pch = 20, legend = text, col = "red")
sum(is.na(dataSet$steps))
sum(is.na(dataSet))
noStepItv
dataSet[is.na(dataSet),steps]
dataSet[is.na(dataSet), dataSet$steps]
dataSet[is.na(dataSet$steps), dataSet$steps]
dataSet[is.na(dataSet$steps), "steps"]
dataSet[is.na(dataSet$steps), 3]
dataSet[1]
dataSet[1,]
noStepItv
noStepItv[,"interval"] == 0
[noStepItv$interval == dataSet[is.na(dataSet$steps),3]
noStepItv$interval == dataSet[is.na(dataSet$steps),3]
dataSet[is.na(dataSet$steps),3]
noStepItv$interval == dataSet[is.na(dataSet$steps)[1],3]
dataSet[is.na(dataSet$steps)[1],3]
is.na(dataSet$steps)[1]
is.na(dataSet$steps)
dataSet[is.na(dataSet$steps)[1],3]
missing_interval <- dataSet[is.na(dataSet$steps)[1],3]
missing_interval
row.match
?match
missing_interval[1]
missing_interval[1] %in% noStepItv$interval
?mutate
noStepItv
ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"]] , dataSet[1,"steps"]
)
ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
if_else(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
dataSetNew <- as_tibble(dataSet)
mutate(dataSetNew, stepsNew = ifelse(is.na(steps), noStepItv[noStepItv$interval == interval,2] , steps))
ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
a <- ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1a,"steps"])
ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
a <- ifelse(is.na(dataSet[1,"steps"]), noStepItv[noStepItv$interval == dataSet[1,"interval"],2] , dataSet[1,"steps"])
a
unlist(a)
?is.na
missingSteps <- which(is.na(dataSet$steps))
missingSteps
length(missingSteps)
dataSetNew
dataSetNew[,steps]
ind <- 1
dataSetNew[ind,"interval"]
noStepItv$interval == dataSetNew[ind,"interval"]
for (ind in missingSteps){
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"steps"]
}
noStepItv
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
dataSetNew
missingSteps
missingSteps <- which(is.na(dataSet$steps))
length(missingSteps)
dataSetNew <- as_tibble(dataSet)
for (ind in missingSteps){
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
}
dataSetNew[1,"steps"]
noStepItv$interval
missingSteps <- which(is.na(dataSet$steps))
length(missingSteps)
dataSetNew <- as_tibble(dataSet)
for (ind in missingSteps){
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
cat( noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"])
}
missingSteps <- which(is.na(dataSet$steps))
length(missingSteps)
dataSetNew <- as_tibble(dataSet)
for (ind in missingSteps){
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
}
nd in missingSteps
missingSteps
missingSteps <- which(is.na(dataSet$steps))
length(missingSteps)
dataSetNew <- as_tibble(dataSet)
for (ind in missingSteps){
#dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
}
for (ind in missingSteps){
#dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
cat(noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"])
}
ind <- 1
noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
dataSetNew[ind,"interval"]
noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
dataSetNew <- dataSet
noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
class(noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"])
missingSteps <- which(is.na(dataSet$steps))
length(missingSteps)
dataSetNew <- dataSet
for (ind in missingSteps){
dataSetNew[ind, "steps"] <- noStepItv[noStepItv$interval == dataSetNew[ind,"interval"],"meansteps"]
}
dataSetNew
View(dataSetNew)
View(noStepItv)
noStepDayNew <- dataSetNew %>% group_by(date) %>% summarise(sum = sum(steps))
hist(noStepDayNew$sum, 15, col = "grey", main = "Histogram of total number of steps taken per day", xlab = "Total number of steps taken per day (NA ommitted)")
summary(noStepDayNew)
summary(noStepDayNew$sum)
summary(noStepDay$sum)
hist(noStepDay$sum, 15, col = "grey", main = "Histogram of total number of steps taken per day", xlab = "Total number of steps taken per day")
is.na(dataSetNew)
sum(is.na(dataSetNew))
noStepDayNew
sum(is.na(noStepDayNew))
sum(is.na(noStepDayNew$sum))
summary(noStepDayNew$sum)
summary(noStepDay$sum)
weekdays(noStepDayNew$date)
?weekdays
as.POSIXlt(noStepDayNew$date)$wday
ifelse(as.POSIXlt(noStepDayNew$date)$wday ==0 |as.POSIXlt(noStepDayNew$date)$wday ==6, "weekend", "weekday")
dataSetNew <- mutate(dataSetNew, wday = ifelse(as.POSIXlt(dataSetNew$date)$wday ==0 |as.POSIXlt(dataSetNew$date)$wday ==6, "weekend", "weekday"))
dataSetNew
View(dataSetNew)
dataSetNew$wday == "weekend"
sum(dataSetNew$wday == "weekend")
?group_by
group_by(dataSetNew,interval)
group_by(group_by(dataSetNew,interval), wday)
group_by(dataSetNew,interval)
group_by(group_by(dataSetNew,interval), wday)
group_by(dataSetNew wday)
group_by(dataSetNew, wday)
group_by(dataSetNew, interval ~wday)
group_by(dataSetNew, interval ~ wday)
group_by(dataSetNew, interval, wday)
noStepItvWd<- dataSetNew %>% group_by(wday, interval)%>% summarise(meansteps = mean(steps))
noStepItvWd
View(noStepItvWd)
g <- ggplot(noStepItvWd, aes(interval, meansteps, color = wday))
g + geom_line() + facet_grid(. ~ wday)+ggtitle("Mean steps of 5-min interval: weekdays vs weekends")
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(2, 1))
library(lattice)
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(2, 1))
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2))
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2), xlab = "Interval")
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2), xlab = "Interval", ylab = "Number of steps")
densityplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2), xlab = "Interval", ylab = "Number of steps")
lplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2), xlab = "Interval", ylab = "Number of steps")
xyplot(meansteps ~ interval | wday, data = noStepItvWd, layout = c(1, 2), type = "l", xlab = "Interval", ylab = "Number of steps")
